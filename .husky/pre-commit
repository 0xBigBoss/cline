echo "Running pre-commit checks..."

# Run ESLint
echo "Running ESLint..."
npm run lint || {
    echo "❌ ESLint check failed. Please fix the errors and try committing again."
    exit 1
}

# Run Prettier
echo "Running Prettier..."
npm run format || {
    echo "❌ Prettier check failed. Run 'npm run format:fix' to automatically fix formatting issues."
    exit 1
}

echo "✅ All checks passed!"

# Exclude package-lock files
echo "Excluding Package-lock Files"
(git diff --name-only --cached | grep -q '^package-lock.json$' && git restore --staged package-lock.json && git update-index --skip-worktree package-lock.json) || true
(git diff --name-only --cached | grep -q '^webview-ui/package-lock.json$' && git restore --staged webview-ui/package-lock.json && git update-index --skip-worktree webview-ui/package-lock.json) || true
